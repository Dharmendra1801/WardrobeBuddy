<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Products Testing</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        input, button, select { margin: 5px; padding: 5px; }
        .section { margin-bottom: 30px; border-bottom: 1px solid #ccc; padding-bottom: 20px; }
        pre { background: #f4f4f4; padding: 10px; }
        #message { color: green; }
    </style>
</head>
<body>
<h1>Products Testing</h1>

<div>
    <label>Auth Token: <input type="text" id="authToken" placeholder="Paste token"></label>
    <label>Username: <input type="text" id="username" placeholder="Username"></label>
    <label>Wardrobe Name: <input type="text" id="wardrobeName" placeholder="Wardrobe"></label>
</div>

<div class="section">
    <h2>Show All Products</h2>
    <button onclick="showAllProducts()">Show All</button>
    <pre id="allProducts"></pre>
</div>

<div class="section">
    <h2>Filter by Product Type</h2>
    <input type="text" id="filterType" placeholder="Product Type">
    <button onclick="filterProducts()">Filter</button>
    <pre id="filteredProducts"></pre>
</div>

<div class="section">
    <h2>Add Product</h2>
    <input type="text" id="addType" placeholder="Product Type">
    <input type="text" id="addName" placeholder="Product Name">
    <input type="text" id="addPrice" placeholder="Price">
    <button onclick="addProduct()">Add</button>
</div>

<div class="section">
    <h2>Update Product</h2>
    <input type="text" id="updateType" placeholder="Product Type">
    <input type="number" id="updateID" placeholder="Product ID">
    <input type="text" id="updateName" placeholder="Product Name">
    <input type="text" id="updatePrice" placeholder="Price">
    <button onclick="updateProduct()">Update</button>
</div>

<div class="section">
    <h2>Delete Product</h2>
    <input type="text" id="deleteType" placeholder="Product Type">
    <input type="number" id="deleteID" placeholder="Product ID">
    <button onclick="deleteProduct()">Delete</button>
</div>

<div id="message"></div>

<script>
    function getHeaders() {
        return { "auth_token": document.getElementById("authToken").value, "Content-Type": "application/json" };
    }
    function getBasePath() {
        const username = document.getElementById("username").value;
        const wardrobe = document.getElementById("wardrobeName").value;
        return `/api/${username}/${wardrobe}`;
    }

    function showAllProducts() {
        fetch(`${getBasePath()}/get_all_products`, { headers: getHeaders() })
        .then(res => res.json())
        .then(data => document.getElementById("allProducts").innerText = JSON.stringify(data, null, 2));
    }

    function filterProducts() {
        const type = document.getElementById("filterType").value;
        fetch(`${getBasePath()}/get_products/${type}`, { headers: getHeaders() })
        .then(res => res.json())
        .then(data => document.getElementById("filteredProducts").innerText = JSON.stringify(data, null, 2));
    }

    function addProduct() {
        const type = document.getElementById("addType").value;
        const name = document.getElementById("addName").value;
        const price = document.getElementById("addPrice").value;

        fetch(`${getBasePath()}/add_product/${type}`, {
            method: "POST",
            headers: getHeaders(),
            body: JSON.stringify({ name, price })
        })
        .then(res => res.text())
        .then(msg => document.getElementById("message").innerText = msg);
    }

    function updateProduct() {
        const type = document.getElementById("updateType").value;
        const id = document.getElementById("updateID").value;
        const name = document.getElementById("updateName").value;
        const price = document.getElementById("updatePrice").value;

        fetch(`${getBasePath()}/update/${type}/${id}`, {
            method: "POST",
            headers: getHeaders(),
            body: JSON.stringify({ name, price })
        })
        .then(res => res.text())
        .then(msg => document.getElementById("message").innerText = msg);
    }

    function deleteProduct() {
        const type = document.getElementById("deleteType").value;
        const id = document.getElementById("deleteID").value;

        fetch(`${getBasePath()}/delete/${type}/${id}`, { method: "DELETE", headers: getHeaders() })
        .then(res => res.text())
        .then(msg => document.getElementById("message").innerText = msg);
    }
</script>
</body>
</html>
